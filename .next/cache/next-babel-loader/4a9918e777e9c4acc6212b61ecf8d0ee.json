{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Layout from '../../../components/MyLayout';\nimport 'isomorphic-unfetch';\nimport Link from 'next/link';\nimport React, { Component, createRef } from 'react';\nimport { connect } from 'react-redux';\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2 } from 'react-html-parser';\nimport { Helmet } from 'react-helmet';\nimport { saveNovel } from '../../../redux/actions/novelActions';\nimport { Container, Breadcrumb, Divider, Dropdown, Grid, Header, Icon, Image, List, Menu, Segment, Visibility, Item, Sticky, Rail, Ref, Button } from 'semantic-ui-react';\nconst menuStyle = {\n  border: 'none',\n  borderRadius: 0,\n  boxShadow: 'none',\n  marginBottom: '1em',\n  marginTop: '4em',\n  transition: 'box-shadow 0.5s ease, padding 0.5s ease'\n};\nconst fixedMenuStyle = {\n  backgroundColor: '#fff',\n  border: '1px solid #ddd',\n  boxShadow: '0px 3px 5px rgba(0, 0, 0, 0.2)'\n};\n\nclass Chapter extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"contextRef\", /*#__PURE__*/createRef());\n\n    _defineProperty(this, \"handleOverlayRef\", c => {\n      const {\n        overlayRect\n      } = this.state;\n\n      if (!overlayRect) {\n        this.setState({\n          overlayRect: _.pick(c.getBoundingClientRect(), 'height', 'width')\n        });\n      }\n    });\n\n    _defineProperty(this, \"stickOverlay\", () => this.setState({\n      overlayFixed: true\n    }));\n\n    _defineProperty(this, \"stickTopMenu\", () => this.setState({\n      menuFixed: true\n    }));\n\n    _defineProperty(this, \"unStickOverlay\", () => this.setState({\n      overlayFixed: false\n    }));\n\n    _defineProperty(this, \"unStickTopMenu\", () => this.setState({\n      menuFixed: false\n    }));\n\n    this.state = {\n      prechap: '',\n      nextchap: '',\n      menuFixed: false,\n      overlayFixed: false\n    };\n  }\n\n  static async getInitialProps(context) {\n    // eslint-disable-next-line no-undef\n    const {\n      id,\n      chapter\n    } = context.query;\n    const res = await fetch(`http://localhost:8001/chapter?novelid=${id}&chapterid=${chapter}`); // const res1 = await fetch(`http://localhost:8001/novel?id=${id}`)\n\n    const json = await res.json(); // const json1 = await res1.json();\n    // let prechap = '', nextchap = ''\n    // if (json1.chapterlist.length === 1) {\n    //     return { novelchapter: json, prechap: '', nextchap: '' }\n    // } else {\n    //     for (let i = 0; i < json1.chapterlist.length; i++) {\n    //         if (\n    //             json.idchapter ===\n    //             json1.chapterlist[i].idchapter\n    //         ) {\n    //             if (i === 0) {\n    //                 return { novelchapter: json, prechap: '', nextchap: json1.chapterlist[i + 1].idchapter }\n    //             }\n    //             if (i > 0 && i < json1.chapterlist.length - 1) {\n    //                 return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: json1.chapterlist[i + 1].idchapter }\n    //             }\n    //             if (i === json1.chapterlist.length - 1) {\n    //                 return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: '' }\n    //             }\n    //         }\n    //     }\n    // }\n    // console.log(json)\n\n    return {\n      novelchapter: json\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.novelchapter !== prevProps.novelchapter) {\n      fetch(`http://localhost:8001/novel?id=${this.props.novelchapter.idnovels}`).then(r => r.json()).then(data => {\n        if (data.chapterlist.length === 1) {\n          this.state({\n            prechap: '',\n            nextchap: ''\n          });\n        } else {\n          for (let i = 0; i < data.chapterlist.length; i++) {\n            if (this.props.novelchapter.idchapter === data.chapterlist[i].idchapter) {\n              if (i === 0) {\n                this.setState({\n                  prechap: '',\n                  nextchap: data.chapterlist[i + 1].idchapter\n                }); // return { novelchapter: json, prechap: '', nextchap: json1.chapterlist[i + 1].idchapter }\n              }\n\n              if (i > 0 && i < data.chapterlist.length - 1) {\n                this.setState({\n                  prechap: data.chapterlist[i - 1].idchapter,\n                  nextchap: data.chapterlist[i + 1].idchapter\n                }); // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: json1.chapterlist[i + 1].idchapter }\n              }\n\n              if (i === data.chapterlist.length - 1) {\n                this.setState({\n                  prechap: data.chapterlist[i - 1].idchapter,\n                  nextchap: ''\n                }); // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: '' }\n              }\n            }\n          }\n        }\n      });\n    }\n  }\n\n  componentDidMount() {\n    fetch(`http://localhost:8001/novel?id=${this.props.novelchapter.idnovels}`).then(r => r.json()).then(data => {\n      this.props.saveNovel(data);\n\n      if (data.chapterlist.length === 1) {\n        this.state({\n          prechap: '',\n          nextchap: ''\n        });\n      } else {\n        for (let i = 0; i < data.chapterlist.length; i++) {\n          if (this.props.novelchapter.idchapter === data.chapterlist[i].idchapter) {\n            if (i === 0) {\n              this.setState({\n                prechap: '',\n                nextchap: data.chapterlist[i + 1].idchapter\n              }); // return { novelchapter: json, prechap: '', nextchap: json1.chapterlist[i + 1].idchapter }\n            }\n\n            if (i > 0 && i < data.chapterlist.length - 1) {\n              this.setState({\n                prechap: data.chapterlist[i - 1].idchapter,\n                nextchap: data.chapterlist[i + 1].idchapter\n              }); // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: json1.chapterlist[i + 1].idchapter }\n            }\n\n            if (i === data.chapterlist.length - 1) {\n              this.setState({\n                prechap: data.chapterlist[i - 1].idchapter,\n                nextchap: ''\n              }); // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: '' }\n            }\n          }\n        }\n      }\n    });\n  }\n\n  render() {\n    console.log(this.props);\n    console.log(this.state);\n    const {\n      menuFixed,\n      overlayFixed,\n      overlayRect\n    } = this.state;\n    return __jsx(Layout, null, __jsx(\"style\", null, `\n          html, body {\n            background: #f5f7fa;\n          }\n        `), __jsx(Helmet, null, __jsx(\"title\", null, `Đọc ${this.props.novelchapter.chaptername}`, \" - YYtruyen\"), __jsx(\"meta\", {\n      name: \"description\",\n      content: `Đọc truyện ${this.props.novelchapter.chaptername} online free tại yytruyen.com, cập nhật các chương mới nhất của truyện này tại đây nhé`\n    }), __jsx(\"meta\", {\n      name: \"theme-color\",\n      content: \"#008f68\"\n    }), __jsx(\"meta\", {\n      name: \"keywords\",\n      content: \"\\u0111\\u1ECDc truy\\u1EC7n online, truy\\u1EC7n online, truy\\u1EC7n ng\\xF4n t\\xECnh, truy\\u1EC7n ki\\u1EBFm hi\\u1EC7p, truy\\u1EC7n ng\\u01B0\\u1EE3c, s\\u1EE7ng\"\n    })), __jsx(Visibility, {\n      onBottomPassed: this.stickTopMenu,\n      onBottomVisible: this.unStickTopMenu,\n      once: false\n    }, __jsx(Menu, {\n      borderless: true,\n      fixed: menuFixed ? 'top' : undefined,\n      style: menuFixed ? fixedMenuStyle : menuStyle\n    }, __jsx(Container, null, __jsx(Menu.Item, null, __jsx(Image, {\n      size: \"tiny\",\n      src: \"/logo.png\"\n    })), __jsx(Menu.Item, {\n      header: true\n    }, __jsx(Breadcrumb, {\n      size: 'large'\n    }, __jsx(Breadcrumb.Section, {\n      link: true\n    }, __jsx(Link, {\n      href: \"/\"\n    }, \"Home\")), __jsx(Breadcrumb.Divider, {\n      icon: \"right chevron\"\n    }), __jsx(Breadcrumb.Section, {\n      link: true\n    }, this.props.novelReducer.novelname), __jsx(Breadcrumb.Divider, {\n      icon: \"right chevron\"\n    }), __jsx(Breadcrumb.Section, {\n      active: true\n    }, this.props.novelchapter.chaptername)))))), __jsx(Container, {\n      text: true\n    }, __jsx(Segment, {\n      textAlign: \"center\",\n      style: {\n        padding: '1em 0em',\n        display: 'grid',\n        justifyContent: 'center'\n      },\n      vertical: true\n    }, __jsx(Image, {\n      className: \"item-img\",\n      src: this.props.novelReducer.cover,\n      style: {\n        height: 240,\n        width: 200\n      }\n    }), __jsx(Header, {\n      as: \"h2\",\n      content: \"Do whatever you want when you want to.\",\n      inverted: true,\n      style: {\n        fontSize: '1.7em',\n        fontWeight: 'normal',\n        marginTop: '1.5em'\n      }\n    }))), __jsx(Container, {\n      text: true,\n      style: {\n        backgroundColor: '#fff'\n      }\n    }, __jsx(Grid, {\n      style: {\n        marginTop: 20\n      }\n    }, __jsx(Grid.Column, {\n      className: \"detail-container\",\n      mobile: 16,\n      tablet: 16,\n      computer: 16\n    }, __jsx(Ref, {\n      innerRef: this.contextRef\n    }, __jsx(Segment, null, __jsx(Item.Group, {\n      textAlign: \"left\"\n    }, __jsx(Item.Description, {\n      className: \"content\"\n    }, this.props.novelchapter.content !== undefined ? ReactHtmlParser(this.props.novelchapter.content) : null)), __jsx(Rail, {\n      position: \"right\",\n      style: {\n        marginTop: 100\n      }\n    }, __jsx(Sticky, {\n      offset: 50,\n      bottomOffset: 100,\n      context: this.contextRef\n    }, __jsx(List, null, __jsx(List.Item, null, __jsx(Button, {\n      size: \"large\",\n      circular: true,\n      icon: \"bars\"\n    })), __jsx(List.Item, null, __jsx(Button, {\n      size: \"large\",\n      circular: true,\n      icon: \"font\"\n    })), __jsx(List.Item, null, __jsx(Button, {\n      size: \"large\",\n      circular: true,\n      icon: \"moon\"\n    })))))))))));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    novelReducer: state.novelReducer\n  };\n}\n\nexport default connect(mapStateToProps, {\n  saveNovel\n})(Chapter);","map":{"version":3,"sources":["C:/Users/bakhjem/Desktop/nhattin/nextjstruyen/pages/doc/[id]/[chapter].js"],"names":["Layout","Link","React","Component","createRef","connect","ReactHtmlParser","processNodes","convertNodeToElement","htmlparser2","Helmet","saveNovel","Container","Breadcrumb","Divider","Dropdown","Grid","Header","Icon","Image","List","Menu","Segment","Visibility","Item","Sticky","Rail","Ref","Button","menuStyle","border","borderRadius","boxShadow","marginBottom","marginTop","transition","fixedMenuStyle","backgroundColor","Chapter","constructor","props","c","overlayRect","state","setState","_","pick","getBoundingClientRect","overlayFixed","menuFixed","prechap","nextchap","getInitialProps","context","id","chapter","query","res","fetch","json","novelchapter","componentDidUpdate","prevProps","prevState","idnovels","then","r","data","chapterlist","length","i","idchapter","componentDidMount","render","console","log","chaptername","stickTopMenu","unStickTopMenu","undefined","novelReducer","novelname","padding","display","justifyContent","cover","height","width","fontSize","fontWeight","contextRef","content","mapStateToProps"],"mappings":"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","sourcesContent":["import Layout from '../../../components/MyLayout'\r\nimport 'isomorphic-unfetch'\r\nimport Link from 'next/link'\r\nimport React, { Component, createRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2 } from 'react-html-parser';\r\nimport { Helmet } from 'react-helmet';\r\nimport { saveNovel } from '../../../redux/actions/novelActions'\r\nimport {\r\n    Container, Breadcrumb,\r\n    Divider,\r\n    Dropdown,\r\n    Grid,\r\n    Header,\r\n    Icon,\r\n    Image,\r\n    List,\r\n    Menu,\r\n    Segment,\r\n    Visibility,\r\n    Item,\r\n    Sticky, Rail,\r\n    Ref, Button\r\n} from 'semantic-ui-react';\r\n\r\nconst menuStyle = {\r\n    border: 'none',\r\n    borderRadius: 0,\r\n    boxShadow: 'none',\r\n    marginBottom: '1em',\r\n    marginTop: '4em',\r\n    transition: 'box-shadow 0.5s ease, padding 0.5s ease',\r\n}\r\n\r\nconst fixedMenuStyle = {\r\n    backgroundColor: '#fff',\r\n    border: '1px solid #ddd',\r\n    boxShadow: '0px 3px 5px rgba(0, 0, 0, 0.2)',\r\n}\r\nclass Chapter extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            prechap: '',\r\n            nextchap: '',\r\n            menuFixed: false,\r\n            overlayFixed: false,\r\n        }\r\n    }\r\n    contextRef = createRef()\r\n    handleOverlayRef = (c) => {\r\n        const { overlayRect } = this.state\r\n\r\n        if (!overlayRect) {\r\n            this.setState({ overlayRect: _.pick(c.getBoundingClientRect(), 'height', 'width') })\r\n        }\r\n    }\r\n\r\n    stickOverlay = () => this.setState({ overlayFixed: true })\r\n\r\n    stickTopMenu = () => this.setState({ menuFixed: true })\r\n\r\n    unStickOverlay = () => this.setState({ overlayFixed: false })\r\n\r\n    unStickTopMenu = () => this.setState({ menuFixed: false })\r\n    static async getInitialProps(context) {\r\n        // eslint-disable-next-line no-undef\r\n        const { id, chapter } = context.query\r\n        const res = await fetch(`http://localhost:8001/chapter?novelid=${id}&chapterid=${chapter}`)\r\n        // const res1 = await fetch(`http://localhost:8001/novel?id=${id}`)\r\n        const json = await res.json()\r\n        // const json1 = await res1.json();\r\n        // let prechap = '', nextchap = ''\r\n        // if (json1.chapterlist.length === 1) {\r\n        //     return { novelchapter: json, prechap: '', nextchap: '' }\r\n        // } else {\r\n        //     for (let i = 0; i < json1.chapterlist.length; i++) {\r\n        //         if (\r\n        //             json.idchapter ===\r\n        //             json1.chapterlist[i].idchapter\r\n        //         ) {\r\n        //             if (i === 0) {\r\n        //                 return { novelchapter: json, prechap: '', nextchap: json1.chapterlist[i + 1].idchapter }\r\n\r\n        //             }\r\n        //             if (i > 0 && i < json1.chapterlist.length - 1) {\r\n        //                 return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: json1.chapterlist[i + 1].idchapter }\r\n        //             }\r\n        //             if (i === json1.chapterlist.length - 1) {\r\n        //                 return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: '' }\r\n        //             }\r\n        //         }\r\n        //     }\r\n        // }\r\n        // console.log(json)\r\n        return { novelchapter: json }\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.novelchapter !== prevProps.novelchapter) {\r\n            fetch(`http://localhost:8001/novel?id=${this.props.novelchapter.idnovels}`)\r\n                .then(r => r.json())\r\n                .then(data => {\r\n                    if (data.chapterlist.length === 1) {\r\n                        this.state({ prechap: '', nextchap: '' })\r\n                    } else {\r\n                        for (let i = 0; i < data.chapterlist.length; i++) {\r\n                            if (\r\n                                this.props.novelchapter.idchapter ===\r\n                                data.chapterlist[i].idchapter\r\n                            ) {\r\n                                if (i === 0) {\r\n                                    this.setState({ prechap: '', nextchap: data.chapterlist[i + 1].idchapter })\r\n                                    // return { novelchapter: json, prechap: '', nextchap: json1.chapterlist[i + 1].idchapter }\r\n\r\n                                }\r\n                                if (i > 0 && i < data.chapterlist.length - 1) {\r\n                                    this.setState({ prechap: data.chapterlist[i - 1].idchapter, nextchap: data.chapterlist[i + 1].idchapter })\r\n                                    // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: json1.chapterlist[i + 1].idchapter }\r\n                                }\r\n                                if (i === data.chapterlist.length - 1) {\r\n                                    this.setState({ prechap: data.chapterlist[i - 1].idchapter, nextchap: '' })\r\n                                    // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: '' }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        fetch(`http://localhost:8001/novel?id=${this.props.novelchapter.idnovels}`)\r\n            .then(r => r.json())\r\n            .then(data => {\r\n                this.props.saveNovel(data)\r\n                if (data.chapterlist.length === 1) {\r\n                    this.state({ prechap: '', nextchap: '' })\r\n                } else {\r\n                    for (let i = 0; i < data.chapterlist.length; i++) {\r\n                        if (\r\n                            this.props.novelchapter.idchapter ===\r\n                            data.chapterlist[i].idchapter\r\n                        ) {\r\n                            if (i === 0) {\r\n                                this.setState({ prechap: '', nextchap: data.chapterlist[i + 1].idchapter })\r\n                                // return { novelchapter: json, prechap: '', nextchap: json1.chapterlist[i + 1].idchapter }\r\n\r\n                            }\r\n                            if (i > 0 && i < data.chapterlist.length - 1) {\r\n                                this.setState({ prechap: data.chapterlist[i - 1].idchapter, nextchap: data.chapterlist[i + 1].idchapter })\r\n                                // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: json1.chapterlist[i + 1].idchapter }\r\n                            }\r\n                            if (i === data.chapterlist.length - 1) {\r\n                                this.setState({ prechap: data.chapterlist[i - 1].idchapter, nextchap: '' })\r\n                                // return { novelchapter: json, prechap: json1.chapterlist[i - 1].idchapter, nextchap: '' }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n\r\n    render() {\r\n        console.log(this.props)\r\n        console.log(this.state)\r\n        const { menuFixed, overlayFixed, overlayRect } = this.state;\r\n        return (\r\n            <Layout>\r\n                <style>\r\n                    {`\r\n          html, body {\r\n            background: #f5f7fa;\r\n          }\r\n        `}\r\n                </style>\r\n                <Helmet>\r\n                    <title>{`Đọc ${this.props.novelchapter.chaptername}`} - YYtruyen</title>\r\n                    <meta name=\"description\" content={`Đọc truyện ${this.props.novelchapter.chaptername} online free tại yytruyen.com, cập nhật các chương mới nhất của truyện này tại đây nhé`} />\r\n                    <meta name=\"theme-color\" content=\"#008f68\" />\r\n                    <meta name=\"keywords\" content=\"đọc truyện online, truyện online, truyện ngôn tình, truyện kiếm hiệp, truyện ngược, sủng\" />\r\n                </Helmet>\r\n                <Visibility\r\n                    onBottomPassed={this.stickTopMenu}\r\n                    onBottomVisible={this.unStickTopMenu}\r\n                    once={false}\r\n                >\r\n                    <Menu\r\n                        borderless\r\n                        fixed={menuFixed ? 'top' : undefined}\r\n                        style={menuFixed ? fixedMenuStyle : menuStyle}\r\n                    >\r\n                        <Container>\r\n                            <Menu.Item>\r\n                                <Image size='tiny' src='/logo.png' />\r\n                            </Menu.Item>\r\n                            <Menu.Item header>\r\n                                <Breadcrumb size={'large'}>\r\n                                    <Breadcrumb.Section link><Link href='/'>Home</Link></Breadcrumb.Section>\r\n                                    <Breadcrumb.Divider icon='right chevron' />\r\n                                    <Breadcrumb.Section link>{this.props.novelReducer.novelname}</Breadcrumb.Section>\r\n                                    <Breadcrumb.Divider icon='right chevron' />\r\n                                    <Breadcrumb.Section active>{this.props.novelchapter.chaptername}</Breadcrumb.Section>\r\n                                </Breadcrumb>\r\n                            </Menu.Item>\r\n                        </Container>\r\n                    </Menu>\r\n                </Visibility>\r\n                <Container text>\r\n                    <Segment\r\n                        textAlign='center'\r\n                        style={{ padding: '1em 0em', display: 'grid', justifyContent: 'center' }}\r\n                        vertical\r\n                    >\r\n                        <Image className='item-img' src={this.props.novelReducer.cover} style={{ height: 240, width: 200 }} />\r\n                        <Header\r\n                            as='h2'\r\n                            content='Do whatever you want when you want to.'\r\n                            inverted\r\n                            style={{\r\n                                fontSize: '1.7em',\r\n                                fontWeight: 'normal',\r\n                                marginTop: '1.5em',\r\n                            }}\r\n                        />\r\n                    </Segment>\r\n                </Container>\r\n                <Container text style={{ backgroundColor: '#fff' }}>\r\n                    <Grid style={{ marginTop: 20 }}>\r\n                        <Grid.Column className='detail-container' mobile={16} tablet={16} computer={16}>\r\n                            <Ref innerRef={this.contextRef}>\r\n                                <Segment>\r\n                                    <Item.Group textAlign='left'>\r\n                                        <Item.Description className='content' >\r\n                                            {this.props.novelchapter.content !== undefined ?\r\n                                                ReactHtmlParser(this.props.novelchapter.content)\r\n                                                : null\r\n                                            }\r\n                                        </Item.Description>\r\n                                    </Item.Group>\r\n                                    <Rail position='right' style={{ marginTop: 100 }}>\r\n                                        <Sticky offset={50} bottomOffset={100} context={this.contextRef}>\r\n                                            <List>\r\n                                                <List.Item>\r\n                                                    <Button size='large' circular icon='bars' />\r\n                                                </List.Item>\r\n                                                <List.Item>\r\n                                                    <Button size='large' circular icon='font' />\r\n                                                </List.Item>\r\n                                                <List.Item>\r\n                                                    <Button size='large' circular icon='moon' />\r\n                                                </List.Item>\r\n                                            </List>\r\n                                        </Sticky>\r\n                                    </Rail>\r\n                                </Segment>\r\n\r\n                            </Ref>\r\n\r\n                        </Grid.Column>\r\n                    </Grid>\r\n                </Container>\r\n                {/* <div className=\"breadcrumb breadcrumbs breadcrumbs_doc\">\r\n                    <div className=\"rdfa-breadcrumb\">\r\n                        <div>\r\n                            <p>\r\n                                <span className=\"breadcrumbs-title\" />\r\n                                <span>\r\n                                    <Link href=\"/\"  >\r\n                                        <a className=\"home\" title=\"Đọc truyện online\">\r\n                                            Đọc truyện online\r\n                                        </a>\r\n                                    </Link>\r\n                                </span>\r\n                                <span className=\"separator\">»</span>\r\n                                <span>\r\n                                    <Link\r\n                                        as={`/truyen/${this.props.novelchapter.idnovels}`}\r\n                                        href={`/truyen/[id]`}\r\n                                    >\r\n                                        <a className=\"home\">\r\n                                            {this.props.novelchapter.novelsname}\r\n                                        </a>\r\n                                    </Link>\r\n                                </span>\r\n                                <span className=\"separator\">»</span>{\" \"}\r\n                                {this.props.novelchapter.chaptername}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"menu_doc\" style={{ flexDirection: 'row', padding: 10 }}>\r\n                    <Link\r\n                        as={`/truyen/${this.props.novelchapter.idnovels}`}\r\n                        href={`/truyen?id=${this.props.novelchapter.idnovels}`}>\r\n                        <a style={{ color: 'white' }}>\r\n                            <button color=\"primary\" style={{ margin: 5 }}>\r\n                                Danh sách chương\r\n            </button>\r\n                        </a>\r\n                    </Link>\r\n                    {this.state.prechap !== \"\" && (\r\n                        <Link\r\n\r\n                            // className=\"btn_theodoi btn_doc\"\r\n                            as={`/doc/${this.props.novelchapter.idnovels}/${this.state.prechap}`}\r\n                            href={`/doc/[id]/[chapter]`}\r\n                        >\r\n                            <a rel=\"nofollow\"\r\n                                style={{ color: 'white' }}>\r\n                                <button style={{ margin: 5 }}>\r\n                                    Chương trước\r\n              </button>\r\n                            </a>\r\n                        </Link>\r\n                    )}\r\n                    {this.state.nextchap !== \"\" && (\r\n\r\n                        <Link\r\n\r\n                            // className=\"btn_theodoi btn_doc\"\r\n                            as={`/doc/${this.props.novelchapter.idnovels}/${this.state.nextchap}`}\r\n                            href={`/doc/[id]/[chapter]`}\r\n                        >\r\n                            <a rel=\"nofollow\"\r\n                                style={{ color: 'white' }}>\r\n                                <button color=\"primary\" style={{ margin: 5 }}>\r\n                                    Chương sau\r\n              </button>\r\n                            </a>\r\n                        </Link>\r\n                    )}\r\n                </div>\r\n                <div className=\"hentry\">\r\n                    <h1 className=\"name_chapter entry-title\">{this.props.novelchapter.chaptername}</h1>\r\n                    <div className=\"entry-content\">\r\n                        <div id=\"vung_doc\" className=\"vung_doc\">\r\n                            {this.props.novelchapter.content !== undefined ?\r\n                                ReactHtmlParser(this.props.novelchapter.content)\r\n                                : null\r\n                            }\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div className=\"menu_doc\" style={{ flexDirection: 'row', padding: 10 }}>\r\n                        <Link\r\n                            as={`/truyen/${this.props.novelchapter.idnovels}`}\r\n                            href={`/truyen/[id]`}>\r\n                            <a style={{ color: 'white' }} >\r\n                                <button color=\"primary\" style={{ margin: 5 }}>\r\n                                    Danh sách chương\r\n            </button>\r\n                            </a>\r\n                        </Link>\r\n                        {this.state.prechap !== \"\" && (\r\n                            <Link\r\n\r\n                                // className=\"btn_theodoi btn_doc\"\r\n                                as={`/doc/${this.props.novelchapter.idnovels}/${this.state.prechap}`}\r\n                                href={`/doc/[id]/[chapter]`}\r\n                            >\r\n                                <a rel=\"nofollow\"\r\n                                    style={{ color: 'white' }}>\r\n                                    <button color=\"primary\" style={{ margin: 5 }}>\r\n                                        Chương trước\r\n              </button>\r\n                                </a>\r\n                            </Link>\r\n                        )}\r\n                        {this.state.nextchap !== \"\" && (\r\n\r\n                            <Link\r\n\r\n                                // className=\"btn_theodoi btn_doc\"\r\n                                as={`/doc/${this.props.novelchapter.idnovels}/${this.state.nextchap}`}\r\n                                href={`/doc/[id]/[chapter]`}\r\n                            >\r\n                                <a rel=\"nofollow\"\r\n                                    style={{ color: 'white' }}>\r\n                                    <button color=\"primary\" style={{ margin: 5 }}>\r\n                                        Chương sau\r\n              </button>\r\n                                </a>\r\n                            </Link>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            */}\r\n            </Layout>\r\n        )\r\n    }\r\n}\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        novelReducer: state.novelReducer\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, { saveNovel })(Chapter);"]},"metadata":{},"sourceType":"module"}